<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.chinasofti.cetp.survey.dao.SurveyMapper" >
  <resultMap id="BaseResultMap" type="com.chinasofti.cetp.survey.model.Survey" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    <id column="SY_SURVEY_ID" property="sySurveyId" jdbcType="INTEGER" />
    <result column="SY_TITLE" property="syTitle" jdbcType="VARCHAR" />
    <result column="SY_TYPE" property="syType" jdbcType="CHAR" />
    <result column="SY_EVENT_IDS" property="syEventIds" jdbcType="VARCHAR" />
    <result column="SY_ENABLE" property="syEnable" jdbcType="CHAR" />
    <result column="SY_START_DATE" property="syStartDate" jdbcType="DATE" />
    <result column="SY_END_DATE" property="syEndDate" jdbcType="DATE" />
    <result column="SY_USER_NO" property="syUserNo" jdbcType="INTEGER" />
    <result column="SY_REGTIME" property="syRegtime" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <resultMap id="SurveysResultMap" type="com.chinasofti.cetp.survey.model.Surveys" >
    <id column="SY_SURVEY_ID" property="sySurveyId" jdbcType="INTEGER" />
    <result column="SY_TITLE" property="syTitle" jdbcType="VARCHAR" />
    <result column="SY_TYPE" property="syType" jdbcType="CHAR" />
    <result column="SY_EVENT_IDS" property="syEventIds" jdbcType="VARCHAR" />
    <result column="SY_ENABLE" property="syEnable" jdbcType="CHAR" />
    <result column="SY_START_DATE" property="syStartDate" jdbcType="DATE" />
    <result column="SY_END_DATE" property="syEndDate" jdbcType="DATE" />
    <result column="SY_USER_NO" property="syUserNo" jdbcType="INTEGER" />
    <result column="SY_REGTIME" property="syRegtime" jdbcType="TIMESTAMP" />
    <association property="user" javaType="com.chinasofti.cetp.admin.model.User">
    	<id column="USER_NO" property="userNo" jdbcType="INTEGER" />
		<result column="USER_ORGID" property="userOrgid" jdbcType="INTEGER" />
		<result column="USER_NAME" property="userName" jdbcType="VARCHAR" />
		<result column="USER_ID" property="userId" jdbcType="VARCHAR" />
		<result column="USER_PWD" property="userPwd" jdbcType="VARCHAR" />
		<result column="USER_NICKNAME" property="userNickname"
			jdbcType="VARCHAR" />
		<result column="USER_MOBILE" property="userMobile" jdbcType="VARCHAR" />
		<result column="USER_PHONE" property="userPhone" jdbcType="VARCHAR" />
		<result column="USER_MAIL" property="userMail" jdbcType="VARCHAR" />
		<result column="USER_QQ" property="userQq" jdbcType="VARCHAR" />
		<result column="USER_GRP_QQ" property="userGrpQq" jdbcType="VARCHAR" />
		<result column="USER_TITLE" property="userTitle" jdbcType="VARCHAR" />
		<result column="USER_SEX" property="userSex" jdbcType="CHAR" />
		<result column="USER_BIRTH" property="userBirth" jdbcType="DATE" />
		<result column="USER_AREA_CODE" property="userAreaCode"
			jdbcType="CHAR" />
		<result column="USER_ADDRESS" property="userAddress" jdbcType="VARCHAR" />
		<result column="USER_POST_CODE" property="userPostCode"
			jdbcType="CHAR" />
		<result column="USER_IS_LEADER" property="userIsLeader"
			jdbcType="CHAR" />
		<result column="USER_EDU_LEVEL" property="userEduLevel"
			jdbcType="CHAR" />
		<result column="USER_SUBJECT" property="userSubject" jdbcType="VARCHAR" />
		<result column="USER_TYPE" property="userType" jdbcType="CHAR" />
		<result column="USER_MARK" property="userMark" jdbcType="VARCHAR" />
		<result column="USER_REGTIME" property="userRegtime" jdbcType="TIMESTAMP" />
    </association>
  </resultMap>
  
  
  
  <resultMap id="EventResultMap" type="com.chinasofti.cetp.survey.model.SurveyEvent" >
    <id column="SY_EVENT_ID" property="eventId" jdbcType="INTEGER" />
    <result column="SY_EVENT_NAME" property="eventName" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.chinasofti.cetp.survey.model.Survey" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    <result column="SY_INTRO" property="syIntro" jdbcType="LONGVARCHAR" />
    <result column="SY_EVENT_NAMES" property="syEventNames" jdbcType="LONGVARCHAR" />
  </resultMap>
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    SY_SURVEY_ID, SY_TITLE, SY_TYPE, SY_EVENT_IDS, SY_ENABLE, SY_START_DATE, SY_END_DATE, SY_USER_NO, 
    SY_REGTIME
  </sql>
 <sql id="User_Column_list">
 	USER_NO,USER_ORGID,USER_NAME,USER_ID,USER_PWD,USER_NICKNAME,USER_MOBILE,USER_PHONE,USER_MAIL,USER_QQ,
 	USER_GRP_QQ,USER_TITLE,USER_SEX,USER_BIRTH
 </sql> 
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    SY_INTRO, SY_EVENT_NAMES
  </sql>
  <select id="selectEventsOfPrac" resultMap="EventResultMap" parameterType="java.lang.String">
  	 select PRAC_ID as SY_EVENT_ID, PRAC_NAME as SY_EVENT_NAME
  	 from tp_practice
  	 <if test="eName != null" >
  	 where PRAC_NAME like #{eName}
     </if>
  </select>
  <select id="selectEventsOfSpec" resultMap="EventResultMap" parameterType="java.lang.String">
  	 select SPEC_ID as SY_EVENT_ID, SPEC_NAME as SY_EVENT_NAME
  	 from TP_SPEC_COURSE
  	 <if test="eName != null" >
  	 where SPEC_NAME like #{eName}
     </if>
  </select>
  <select id="selectEventsOfCourse" resultMap="EventResultMap" parameterType="java.lang.String">
  	 select COURSE_ID as SY_EVENT_ID, COURSE_NAME as SY_EVENT_NAME
  	 from TP_COURSEWARE
  	 <if test="eName != null" >
  	 where COURSE_NAME like #{eName}
     </if>
  </select>
  <select id="selectByExampleWithBLOBs" resultMap="ResultMapWithBLOBs" parameterType="com.chinasofti.cetp.survey.model.SurveyExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from tp_survey
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.chinasofti.cetp.survey.model.SurveyExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from tp_survey
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from tp_survey
    where SY_SURVEY_ID = #{sySurveyId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    delete from tp_survey
    where SY_SURVEY_ID = #{sySurveyId,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByExample" parameterType="com.chinasofti.cetp.survey.model.SurveyExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    delete from tp_survey
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.chinasofti.cetp.survey.model.Survey" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    insert into tp_survey (SY_SURVEY_ID, SY_TITLE, SY_TYPE, SY_EVENT_IDS, 
      SY_ENABLE, SY_START_DATE, SY_END_DATE, 
      SY_USER_NO, SY_REGTIME, SY_INTRO
      )
    values (#{sySurveyId,jdbcType=INTEGER}, #{syTitle,jdbcType=VARCHAR}, #{syType,jdbcType=CHAR}, #{syEventIds,jdbcType=VARCHAR}, 
      #{syEnable,jdbcType=CHAR}, #{syStartDate,jdbcType=DATE}, #{syEndDate,jdbcType=DATE}, 
      #{syUserNo,jdbcType=INTEGER}, #{syRegtime,jdbcType=TIMESTAMP}, #{syIntro,jdbcType=LONGVARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.chinasofti.cetp.survey.model.Survey"  useGeneratedKeys="true" keyProperty="sySurveyId">
    <!-- edit by yf 2013-9-26 -->
    insert into tp_survey
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="sySurveyId != null" >
        SY_SURVEY_ID,
      </if>
      <if test="syTitle != null" >
        SY_TITLE,
      </if>
      <if test="syType != null" >
        SY_TYPE,
      </if>
      <if test="syEventIds != null" >
        SY_EVENT_IDS,
      </if>
      <if test="syEventNames != null" >
        SY_EVENT_NAMES,
      </if>
      <if test="syEnable != null" >
        SY_ENABLE,
      </if>
      <if test="syStartDate != null" >
        SY_START_DATE,
      </if>
      <if test="syEndDate != null" >
        SY_END_DATE,
      </if>
      <if test="syUserNo != null" >
        SY_USER_NO,
      </if>
      <if test="syRegtime != null" >
        SY_REGTIME,
      </if>
      <if test="syIntro != null" >
        SY_INTRO,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="sySurveyId != null" >
        #{sySurveyId,jdbcType=INTEGER},
      </if>
      <if test="syTitle != null" >
        #{syTitle,jdbcType=VARCHAR},
      </if>
      <if test="syType != null" >
        #{syType,jdbcType=CHAR},
      </if>
      <if test="syEventIds != null" >
        #{syEventIds,jdbcType=VARCHAR},
      </if>
      <if test="syEventNames != null" >
        #{syEventNames,jdbcType=LONGVARCHAR},
      </if>
      <if test="syEnable != null" >
        #{syEnable,jdbcType=CHAR},
      </if>
      <if test="syStartDate != null" >
        #{syStartDate,jdbcType=DATE},
      </if>
      <if test="syEndDate != null" >
        #{syEndDate,jdbcType=DATE},
      </if>
      <if test="syUserNo != null" >
        #{syUserNo,jdbcType=INTEGER},
      </if>
      <if test="syRegtime != null" >
        #{syRegtime,jdbcType=TIMESTAMP},
      </if>
      <if test="syIntro != null" >
        #{syIntro,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.chinasofti.cetp.survey.model.SurveyExample" resultType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    select count(*) from tp_survey
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    update tp_survey
    <set >
      <if test="record.sySurveyId != null" >
        SY_SURVEY_ID = #{record.sySurveyId,jdbcType=INTEGER},
      </if>
      <if test="record.syTitle != null" >
        SY_TITLE = #{record.syTitle,jdbcType=VARCHAR},
      </if>
      <if test="record.syType != null" >
        SY_TYPE = #{record.syType,jdbcType=CHAR},
      </if>
      <if test="record.syEventIds != null" >
        SY_EVENT_IDS = #{record.syEventIds,jdbcType=VARCHAR},
      </if>
      <if test="record.syEnable != null" >
        SY_ENABLE = #{record.syEnable,jdbcType=CHAR},
      </if>
      <if test="record.syStartDate != null" >
        SY_START_DATE = #{record.syStartDate,jdbcType=DATE},
      </if>
      <if test="record.syEndDate != null" >
        SY_END_DATE = #{record.syEndDate,jdbcType=DATE},
      </if>
      <if test="record.syUserNo != null" >
        SY_USER_NO = #{record.syUserNo,jdbcType=INTEGER},
      </if>
      <if test="record.syRegtime != null" >
        SY_REGTIME = #{record.syRegtime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.syIntro != null" >
        SY_INTRO = #{record.syIntro,jdbcType=LONGVARCHAR},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExampleWithBLOBs" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    update tp_survey
    set SY_SURVEY_ID = #{record.sySurveyId,jdbcType=INTEGER},
      SY_TITLE = #{record.syTitle,jdbcType=VARCHAR},
      SY_TYPE = #{record.syType,jdbcType=CHAR},
      SY_EVENT_IDS = #{record.syEventIds,jdbcType=VARCHAR},
      SY_ENABLE = #{record.syEnable,jdbcType=CHAR},
      SY_START_DATE = #{record.syStartDate,jdbcType=DATE},
      SY_END_DATE = #{record.syEndDate,jdbcType=DATE},
      SY_USER_NO = #{record.syUserNo,jdbcType=INTEGER},
      SY_REGTIME = #{record.syRegtime,jdbcType=TIMESTAMP},
      SY_INTRO = #{record.syIntro,jdbcType=LONGVARCHAR}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    update tp_survey
    set SY_SURVEY_ID = #{record.sySurveyId,jdbcType=INTEGER},
      SY_TITLE = #{record.syTitle,jdbcType=VARCHAR},
      SY_TYPE = #{record.syType,jdbcType=CHAR},
      SY_EVENT_IDS = #{record.syEventIds,jdbcType=VARCHAR},
      SY_ENABLE = #{record.syEnable,jdbcType=CHAR},
      SY_START_DATE = #{record.syStartDate,jdbcType=DATE},
      SY_END_DATE = #{record.syEndDate,jdbcType=DATE},
      SY_USER_NO = #{record.syUserNo,jdbcType=INTEGER},
      SY_REGTIME = #{record.syRegtime,jdbcType=TIMESTAMP}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.chinasofti.cetp.survey.model.Survey" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    update tp_survey
    <set >
      <if test="syTitle != null" >
        SY_TITLE = #{syTitle,jdbcType=VARCHAR},
      </if>
      <if test="syType != null" >
        SY_TYPE = #{syType,jdbcType=CHAR},
      </if>
      <if test="syEventIds != null" >
        SY_EVENT_IDS = #{syEventIds,jdbcType=VARCHAR},
      </if>
      <if test="syEnable != null" >
        SY_ENABLE = #{syEnable,jdbcType=CHAR},
      </if>
      <if test="syStartDate != null" >
        SY_START_DATE = #{syStartDate,jdbcType=DATE},
      </if>
      <if test="syEndDate != null" >
        SY_END_DATE = #{syEndDate,jdbcType=DATE},
      </if>
      <if test="syUserNo != null" >
        SY_USER_NO = #{syUserNo,jdbcType=INTEGER},
      </if>
      <if test="syRegtime != null" >
        SY_REGTIME = #{syRegtime,jdbcType=TIMESTAMP},
      </if>
      <if test="syIntro != null" >
        SY_INTRO = #{syIntro,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where SY_SURVEY_ID = #{sySurveyId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.chinasofti.cetp.survey.model.Survey" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    update tp_survey
    set SY_TYPE = #{syType,jdbcType=CHAR},
      SY_TITLE = #{syTitle,jdbcType=VARCHAR},
      SY_EVENT_IDS = #{syEventIds,jdbcType=VARCHAR},
      SY_EVENT_NAMES = #{syEventNames,jdbcType=LONGVARCHAR},
      SY_ENABLE = #{syEnable,jdbcType=CHAR},
      SY_START_DATE = #{syStartDate,jdbcType=DATE},
      SY_END_DATE = #{syEndDate,jdbcType=DATE},
      SY_USER_NO = #{syUserNo,jdbcType=INTEGER},
      SY_REGTIME = #{syRegtime,jdbcType=TIMESTAMP},
      SY_INTRO = #{syIntro,jdbcType=LONGVARCHAR}
    where SY_SURVEY_ID = #{sySurveyId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.chinasofti.cetp.survey.model.Survey" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 25 20:01:32 CST 2013.
    -->
    update tp_survey
    set SY_TYPE = #{syType,jdbcType=CHAR},
      SY_TITLE = #{record.syTitle,jdbcType=VARCHAR},
      SY_EVENT_IDS = #{syEventIds,jdbcType=VARCHAR},
      SY_ENABLE = #{syEnable,jdbcType=CHAR},
      SY_START_DATE = #{syStartDate,jdbcType=DATE},
      SY_END_DATE = #{syEndDate,jdbcType=DATE},
      SY_USER_NO = #{syUserNo,jdbcType=INTEGER},
      SY_REGTIME = #{syRegtime,jdbcType=TIMESTAMP}
    where SY_SURVEY_ID = #{sySurveyId,jdbcType=INTEGER}
  </update>
  <select id="selectByPage" resultMap="BaseResultMap" parameterType="map">
  	select 
  	<include refid="Base_Column_List"/>
  	from TP_SURVEY 
  	<where>
  		<if test="syTitle!=null">SY_TITLE like #{syTitle}</if>
  	</where>
  	<if test="sort!=null">
			order by ${sort}
			<if test="order!=null">
			${order}
			</if>
	</if>
	limit #{pageOffset},#{pageSize}
  </select>
  <select id="count" resultType="int" parameterType="map">
  	select 
  		count(*) 
  	from 
  		TP_SURVEY t1 inner join TP_USER t2 on t1.SY_USER_NO = t2.USER_NO  
  	<where>
  		<if test="syTitle!=null">
  			SY_TITLE like #{syTitle}
  		</if>
  		<if test="userName!=null">
  			AND USER_NAME like #{userName}
  		</if>
  		<if test="syEnable!=null">
  			AND SY_ENABLE = #{syEnable}
  		</if>
  		<if test="syRegtime!=null">
  			AND SY_REGTIME like #{syRegtime}
  		</if>
  		<if test="syStartDate!=null">
  			AND SY_START_DATE like #{syStartDate}
  		</if>
  		<if test="syEndDate!=null">
  			AND SY_END_DATE like #{syEndDate}
  		</if>
  	</where>
  </select>
  
  <select id="selectSurveysByPage" resultMap="SurveysResultMap" parameterType="map">
  	select 
  	<include refid="Base_Column_List"/>,
  	<include refid="User_Column_list"/>,
  	(select COUNT(SI_SURVEY_ID) from tp_survey_inst where SI_SURVEY_ID = SY_SURVEY_ID) as Info
  	from TP_SURVEY t1 inner join TP_USER t2 on t1.SY_USER_NO = t2.USER_NO 
  	<where>
  		<if test="syTitle!=null">
  			t1.SY_TITLE like #{syTitle}
  		</if>
  		<if test="userName!=null">
  			AND t2.USER_NAME like #{userName}
  		</if>
  		<if test="syEnable!=null">
  			AND t1.SY_ENABLE = #{syEnable}
  		</if>
  		<if test="syRegtime!=null">
  			AND t1.SY_REGTIME like #{syRegtime}
  		</if>
  		<if test="syStartDate!=null">
  			AND t1.SY_START_DATE like #{syStartDate}
  		</if>
  		<if test="syEndDate!=null">
  			AND t1.SY_END_DATE like #{syEndDate}
  		</if>
  	</where>
  	<if test="sort!=null">
			order by ${sort}
			<if test="order!=null">
			${order}
			</if>
	</if>
	limit #{pageOffset},#{pageSize}
  </select>
  <select id="selectSurveysByPage2" resultMap="BaseResultMap" parameterType="map">
	SELECT
		<include refid="Base_Column_List"/>
	FROM
		tp_survey
	WHERE
		(
			SY_TYPE = '05'
			OR (
				SY_TYPE = '01'
				AND (
					SELECT
						count(0)
					FROM
						TP_PRACTICE_CLASS
					INNER JOIN tp_student ON (
						PC_CLASS_ID = STU_CLASS_ID
						AND STU_NO = #{stuNo}
					)
					WHERE
						FIND_IN_SET(PC_PRAC_ID, SY_EVENT_IDS) > 0
				) > 0
			)
			OR (
				SY_TYPE = '02'
				AND (
					SELECT
						count(0)
					FROM
						TP_SPEC_STU
					WHERE
						FIND_IN_SET(SU_SPEC_ID, SY_EVENT_IDS) > 0
					AND SU_STU_ID = #{stuNo}
				) > 0
			)
			OR (
				SY_TYPE = '03'
				AND (
					SELECT
						count(0)
					FROM
						TP_COURSE_STU
					WHERE
						FIND_IN_SET(CT_COURSE_ID, SY_EVENT_IDS) > 0
					AND CT_STU_ID = #{stuNo}
				) > 0
			)
		)
	AND SY_SURVEY_ID NOT IN (
		SELECT
			SI_SURVEY_ID
		FROM
			TP_SURVEY_INST
		WHERE
			SI_USER_NO = #{stuNo}
	)
	AND (
		SY_ENABLE = '2'
		OR (
			SY_ENABLE = '1'
			AND (
				now() BETWEEN SY_START_DATE
				AND SY_END_DATE
			)
		)
	)
  	<if test="syTitle!=null">
  		AND SY_TITLE like #{syTitle}
  	</if>
  	order by SY_SURVEY_ID
  </select>
</mapper>